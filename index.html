<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Secure Proxy</title>
</head>
<body>
<h1>Secure Proxy</h1>
<input id="url" type="text" placeholder="Enter target URL">
<button onclick="loadProxy()">Load Website</button>
<iframe id="proxyFrame" style="width:100%; height:80vh;"></iframe>

<script>
async function loadProxy(){
    const url = document.getElementById('url').value;
    if(!url) return alert('Enter a URL');

    // Fetch decrypted HTML directly from backend
    const proxyURL = `http://localhost:14456/api/decrypted?url=${encodeURIComponent(url)}`;

    try{
        const response = await fetch(proxyURL);
        if(!response.ok) throw new Error('Fetch failed: '+response.status);

        const html = await response.text();
        document.getElementById('proxyFrame').srcdoc = html;
    }catch(err){
        console.error(err);
        alert('Error loading proxy: '+err.message);
    }
}
</script>
</body>
</html>
